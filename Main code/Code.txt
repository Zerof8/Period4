Here is the main code.
